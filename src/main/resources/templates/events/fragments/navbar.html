<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <link rel="stylesheet" th:href="@{/css/style.css}">
</head>
<body>
<th:block th:fragment="navbar">
    <header class="nc-header">
        <div class="nc-container">

            <div class="nc-top">
                <a class="nc-logo" th:href="@{/}">
                    <img th:src="@{/images/NatureConnectLogo.png}" alt="Logo">
                    <span class="nc-brand"><strong>NATURE</strong>Connect</span>
                </a>
            </div>

            <div class="nc-divider"></div>

            <nav class="nc-nav" id="nc-nav">
                <!-- LEFT -->
                <ul class="nc-left">
                    <li><a th:href="@{/}">Home</a></li>

                    <li class="dropdown">
                        <a href="#" class="dropbtn">Events ▾</a>
                        <ul class="dropdown-content">
                            <li><a th:href="@{/events}">All Events</a></li>

                            <li sec:authorize="hasAnyRole('ADMIN', 'ORGANIZER')">
                                <a th:href="@{/events/new}">Create Event</a>
                            </li>
                        </ul>
                    </li>

                    <li><a th:href="@{/bookings}">Bookings</a></li>

                    <li sec:authorize="hasAnyRole('FRONT', 'ADMIN')">
                        <a th:href="@{/event_management}">Event Management</a>
                    </li>
                </ul>

                <!-- RIGHT -->
                <ul class="nc-right">

                    <li sec:authorize="!isAuthenticated() or hasRole('CUSTOMER')">
                        <a th:href="@{/about}">About Us</a>
                    </li>

                    <li sec:authorize="!isAuthenticated() or hasRole('CUSTOMER')">
                        <span class="divider">|</span>
                    </li>

                    <li sec:authorize="!isAuthenticated() or hasRole('CUSTOMER')">
                        <a th:href="@{/contact}">Contact Us</a>
                    </li>

                    <li sec:authorize="!isAuthenticated()">
                        <a class="nc-login" th:href="@{/login}">Log In</a>
                    </li>

                    <!-- USER MENU -->
                    <li sec:authorize="isAuthenticated()" class="dropdown">
                        <a href="#" class="dropbtn profile-link">

                            <div class="nav-avatar-wrapper">

                                <!-- echtes Avatar -->
                                <img th:if="${avatarUrl != null}"
                                     th:src="${avatarUrl}"
                                     class="nav-avatar-img"
                                     alt="Avatar">

                                <!-- Initialen (BF) -->
                                <div th:if="${avatarUrl == null}"
                                     class="nav-avatar-placeholder"
                                     th:text="${userInitials}">
                                    BF
                                </div>

                            </div>

                            <span class="nav-username"
                                  th:text="${currentUserName}">
                            </span>

                            <span class="caret">▾</span>
                        </a>



                        <ul class="dropdown-content">

                            <!-- ROLE BADGES (unchanged, good stuff) -->
                            <li class="badge-item" sec:authorize="hasRole('ADMIN')">
                                <div class="badge-card badge-gold">
                                    <span class="badge-role">Back Office</span>
                                    <span class="badge-sub">Admin</span>
                                </div>
                            </li>

                            <li class="badge-item" sec:authorize="hasRole('FRONT')">
                                <div class="badge-card badge-blue">
                                    <span class="badge-role">Front Office</span>
                                </div>
                            </li>

                            <li class="badge-item" sec:authorize="hasRole('ORGANIZER')">
                                <div class="badge-card badge-black">
                                    <span class="badge-role">Organizer</span>
                                </div>
                            </li>

                            <li class="badge-item" sec:authorize="hasRole('CUSTOMER') and !hasRole('ORGANIZER')">
                                <div class="badge-card badge-green">
                                    <span class="badge-role">Customer</span>
                                </div>
                            </li>

                            <li>
                                <a th:href="@{/profile}" class="menu-link">My Profile</a>
                            </li>

                            <li sec:authorize="hasRole('ADMIN')">
                                <a th:href="@{/admin/users}" class="menu-link">Users & Roles</a>
                            </li>

                            <li sec:authorize="hasRole('ADMIN')">
                                <a th:href="@{/admin/logs}" class="menu-link">Logs</a>
                            </li>

                            <li>
                                <form th:action="@{/logout}" method="post" style="margin:0">
                                    <button type="submit" class="logout-btn">Log out</button>
                                </form>
                            </li>

                        </ul>
                    </li>

                </ul>
            </nav>
        </div>
    </header>
</th:block>
</body>
</html>
